/*
 * Note: this file originally auto-generated by mib2c using
 *        : mib2c.notify.conf 10110 2004-04-15 12:29:19Z dts12 $
 */
#include <time.h>
#include <net-snmp/net-snmp-config.h>
#include <net-snmp/net-snmp-includes.h>
#include <net-snmp/agent/net-snmp-agent-includes.h>
#include <stacks.h>
#include <subagent.h>

int seqNum;
static oid      snmptrap_oid[] = { 1, 3, 6, 1, 6, 3, 1, 1, 4, 1, 0 };
extern     netsnmp_session session, *ss;
int
send_diaClearedNotification_trap(StackAlarmInfo * alarmInfo, char *faultText)
{

    unsigned long alarmTime;
    int alarmType;
    int probableCause;
    int alarmSeverity;
    char fault_name[100];
    char alarmIdString[ALARM_ID_LEN]={'\0'};
    netsnmp_variable_list *var_list = NULL;
    int alarmId=alarmInfo->stackAlarmId;
    strncpy(alarmIdString,alarmInfo->alarmIdString,ALARM_ID_LEN - 1);
    alarmIdString[ALARM_ID_LEN - 1] = '\0';
    seqNum++;

    if (seqNum >= MAX_SEQUENCE_NUMBER)
    {
        seqNum = 1;
    }
    sprintf(fault_name, "%s", ALARM_FAULTNAME(alarmId));

    alarmType = ALARM_TYPE(alarmId);

    probableCause = ALARM_PROBABLECAUSE(alarmId);

    alarmSeverity = ALARM_SEVERITY(alarmId);


    oid             diaClearedNotification_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 0 };
    oid             diaNotificationSequenceNum_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1000, 0 };
    oid             diaFaultName_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1001, 0 };
    oid             diaAlarmTime_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1002, 0 };
    oid             diaAlarmType_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1003, 0 };
    oid             diaAlarmProbableCause_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1004, 0 };
    oid             diaAlarmSeverity_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1005, 0 };
    oid             diaAddText_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1006, 0 };
    oid             diaAlarmId_oid[] = 
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1007, 0 };

#if defined(_SOL_SNMP_) 
   oid             objid_sysuptime[] = { 1, 3, 6, 1, 2, 1, 1, 3, 0 };
    oid             objid_snmptrap[] = { 1, 3, 6, 1, 6, 3, 1, 1, 4, 1, 0 };
    netsnmp_pdu    *pdu = NULL;
    int inform = 0;
    pdu = snmp_pdu_create(inform ? SNMP_MSG_INFORM : SNMP_MSG_TRAP2);

    char           *trap = NULL;
    char            csysuptime[20];
    long            sysuptime;
    char            diaNotif[MAX_DIA_NTF_LENGTH+1];

    memset(diaNotif, 0, MAX_DIA_NTF_LENGTH+1);
    sprintf(diaNotif, "%s", "DIA-MIB::diaClearedNotification");
    sysuptime = get_uptime();

    sprintf(csysuptime, "%ld", sysuptime);
    trap = csysuptime;
    snmp_add_var(pdu, objid_sysuptime,
                  sizeof(objid_sysuptime) / sizeof(oid), 't', trap);

    snmp_add_var
           (pdu, diaClearedNotification_oid, sizeof(diaClearedNotification_oid) / sizeof(oid),
            'o', &diaNotif); 

    char varSeqNum[20];
    sprintf(varSeqNum, "%d", seqNum);

    snmp_add_var(pdu,diaNotificationSequenceNum_oid, sizeof(diaNotificationSequenceNum_oid)/sizeof(oid), 'c', &varSeqNum);
    snmp_add_var(pdu,diaFaultName_oid, OID_LENGTH(diaFaultName_oid), 's', &fault_name);
    char varAlmTime[30];
    alarmTime = time(NULL);
    sprintf(varAlmTime, "%d", alarmTime);
    snmp_add_var(pdu,diaAlarmTime_oid, OID_LENGTH(diaAlarmTime_oid), 'u', &varAlmTime);
    char varAlmType[30];
    sprintf(varAlmType, "%d", alarmType);
    snmp_add_var(pdu,diaAlarmType_oid, OID_LENGTH(diaAlarmType_oid), 'i', &varAlmType);
    char varProbCause[30];
    sprintf(varProbCause, "%d", probableCause);
    snmp_add_var(pdu,diaAlarmProbableCause_oid, OID_LENGTH(diaAlarmProbableCause_oid), 'i', &varProbCause);
    char varAlmSev[30];
    sprintf(varAlmSev, "%d", alarmSeverity);
    snmp_add_var(pdu,diaAlarmSeverity_oid, OID_LENGTH(diaAlarmSeverity_oid), 'i', &varAlmSev);
    snmp_add_var(pdu,diaAddText_oid, OID_LENGTH(diaAddText_oid), 's', faultText);
     int status = 0;
          status = snmp_send(ss, pdu) ;
    if (status) {
        snmp_sess_perror(inform ? "snmpinform" : "snmptrapppp", ss);
        //exitval = 1;
    }

#else

    /*
     * Set the snmpTrapOid.0 value
     */
    snmp_varlist_add_variable(&var_list,
                              snmptrap_oid, OID_LENGTH(snmptrap_oid),
                              ASN_OBJECT_ID,
                              diaClearedNotification_oid,
                              sizeof(diaClearedNotification_oid));

    /*
     * Add any objects from the trap definition
     */
 
    snmp_varlist_add_variable(&var_list, 
        diaAlarmId_oid, OID_LENGTH(diaAlarmId_oid), 
        ASN_OCTET_STR, 
        /* Set an appropriate value for diaAlarmId */ 
        alarmIdString,strlen(alarmIdString));


    snmp_varlist_add_variable(&var_list,
                              diaNotificationSequenceNum_oid,
                              OID_LENGTH(diaNotificationSequenceNum_oid),
                              ASN_COUNTER,
                              /*
                               * Set an appropriate value for 
                               * diaNotificationSequenceNum 
                               */
                              (u_char *)&seqNum,            
                              sizeof(seqNum));
    snmp_varlist_add_variable(&var_list,
                              diaFaultName_oid,
                              OID_LENGTH(diaFaultName_oid), ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaFaultName 
                               */
                              fault_name, strlen(fault_name));
    
    alarmTime = time(NULL);

    snmp_varlist_add_variable(&var_list,
                              diaAlarmTime_oid,
                              OID_LENGTH(diaAlarmTime_oid), ASN_UNSIGNED,
                              /*
                               * Set an appropriate value for diaAlarmTime 
                               */
                              (u_char *)&alarmTime, sizeof(alarmTime));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmType_oid,
                              OID_LENGTH(diaAlarmType_oid), ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmType 
                               */
                              (u_char *)&alarmType, sizeof(alarmType));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmProbableCause_oid,
                              OID_LENGTH(diaAlarmProbableCause_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for 
                               * diaAlarmProbableCause 
                               */
                              (u_char *)&probableCause, sizeof(probableCause));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmSeverity_oid,
                              OID_LENGTH(diaAlarmSeverity_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmSeverity 
                               */
                              (u_char *)&alarmSeverity, sizeof(alarmSeverity));
    snmp_varlist_add_variable(&var_list,
                              diaAddText_oid, OID_LENGTH(diaAddText_oid),
                              ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaAddText 
                               */
                              faultText, strlen(faultText));

    /*
     * Add any extra (optional) objects here
     */

    /*
     * Send the trap to the list of configured destinations
     *  and clean up
     */
    send_v2trap(var_list);
    snmp_free_varbind(var_list);
#endif
    return SNMP_ERR_NOERROR;
}

int
send_diaWarningNotification_trap(StackAlarmInfo *alarmInfo, char *faultText)
{
    unsigned long alarmTime;
    int alarmType;
    int probableCause;
    int alarmSeverity;
    char fault_name[100];
    netsnmp_variable_list *var_list = NULL;
    char alarmIdString[ALARM_ID_LEN]={'\0'};
    int alarmId=alarmInfo->stackAlarmId;
    strncpy(alarmIdString,alarmInfo->alarmIdString,ALARM_ID_LEN - 1);
    alarmIdString[ALARM_ID_LEN - 1] = '\0';

    seqNum++;

    if (seqNum >= MAX_SEQUENCE_NUMBER)
    {
        seqNum = 1;
    }

    sprintf(fault_name, "%s", ALARM_FAULTNAME(alarmId));

    alarmType = ALARM_TYPE(alarmId);

    probableCause = ALARM_PROBABLECAUSE(alarmId);

    alarmSeverity = ALARM_SEVERITY(alarmId);


    oid             diaWarningNotification_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1 };
    oid             diaNotificationSequenceNum_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1000, 0 };
    oid             diaFaultName_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1001, 0 };
    oid             diaAlarmTime_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1002, 0 };
    oid             diaAlarmType_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1003, 0 };
    oid             diaAlarmProbableCause_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1004, 0 };
    oid             diaAlarmSeverity_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1005, 0 };
    oid             diaAddText_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1006, 0 };
    oid             diaAlarmId_oid[] = 
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1007, 0 };
#if defined(_SOL_SNMP_) 
    oid             objid_sysuptime[] = { 1, 3, 6, 1, 2, 1, 1, 3, 0 };
    oid             objid_snmptrap[] = { 1, 3, 6, 1, 6, 3, 1, 1, 4, 1, 0 };
    netsnmp_pdu    *pdu = NULL;
    int inform = 0;
    pdu = snmp_pdu_create(inform ? SNMP_MSG_INFORM : SNMP_MSG_TRAP2);

    char           *trap = NULL;
    char            csysuptime[20];
    long            sysuptime;
    char            diaNotif[MAX_DIA_NTF_LENGTH+1];

    memset(diaNotif, 0, MAX_DIA_NTF_LENGTH+1);
    sprintf(diaNotif, "%s", "DIA-MIB::diaWarningNotification");
    sysuptime = get_uptime();

    sprintf(csysuptime, "%ld", sysuptime);
    trap = csysuptime;
    snmp_add_var(pdu, objid_sysuptime,
                  sizeof(objid_sysuptime) / sizeof(oid), 't', trap);

    snmp_add_var
           (pdu, diaWarningNotification_oid, sizeof(diaWarningNotification_oid) / sizeof(oid),
            'o', &diaNotif); 

    char varSeqNum[20];
    sprintf(varSeqNum, "%d", seqNum);

    snmp_add_var(pdu,diaNotificationSequenceNum_oid, sizeof(diaNotificationSequenceNum_oid)/sizeof(oid), 'c', &varSeqNum);
    snmp_add_var(pdu,diaFaultName_oid, OID_LENGTH(diaFaultName_oid), 's', &fault_name);
    char varAlmTime[30];
    alarmTime = time(NULL);
    sprintf(varAlmTime, "%d", alarmTime);
    snmp_add_var(pdu,diaAlarmTime_oid, OID_LENGTH(diaAlarmTime_oid), 'u', &varAlmTime);
    char varAlmType[30];
    sprintf(varAlmType, "%d", alarmType);
    snmp_add_var(pdu,diaAlarmType_oid, OID_LENGTH(diaAlarmType_oid), 'i', &varAlmType);
    char varProbCause[30];
    sprintf(varProbCause, "%d", probableCause);
    snmp_add_var(pdu,diaAlarmProbableCause_oid, OID_LENGTH(diaAlarmProbableCause_oid), 'i', &varProbCause);
    char varAlmSev[30];
    sprintf(varAlmSev, "%d", alarmSeverity);
    snmp_add_var(pdu,diaAlarmSeverity_oid, OID_LENGTH(diaAlarmSeverity_oid), 'i', &varAlmSev);
    snmp_add_var(pdu,diaAddText_oid, OID_LENGTH(diaAddText_oid), 's', faultText);
     int status = 0;
          status = snmp_send(ss, pdu) ;
    if (status) {
        snmp_sess_perror(inform ? "snmpinform" : "snmptrapppp", ss);
        //exitval = 1;
    }

#else
    /*
     * Set the snmpTrapOid.0 value
     */
    snmp_varlist_add_variable(&var_list,
                              snmptrap_oid, OID_LENGTH(snmptrap_oid),
                              ASN_OBJECT_ID,
                              diaWarningNotification_oid,
                              sizeof(diaWarningNotification_oid));

    snmp_varlist_add_variable(&var_list, 
        diaAlarmId_oid, OID_LENGTH(diaAlarmId_oid), 
        ASN_OCTET_STR, 
        /* Set an appropriate value for diaAlarmId */ 
        alarmIdString, strlen(alarmIdString));

    /*
     * Add any objects from the trap definition
     */
    snmp_varlist_add_variable(&var_list,
                              diaNotificationSequenceNum_oid,
                              OID_LENGTH(diaNotificationSequenceNum_oid),
                              ASN_COUNTER,
                              /*
                               * Set an appropriate value for 
                               * diaNotificationSequenceNum 
                               */
                               (u_char *)&seqNum,            
                              sizeof(seqNum));
    snmp_varlist_add_variable(&var_list,
                              diaFaultName_oid,
                              OID_LENGTH(diaFaultName_oid), ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaFaultName 
                               */
                             fault_name, strlen(fault_name));
    
    alarmTime = time(NULL);

    snmp_varlist_add_variable(&var_list,
                              diaAlarmTime_oid,
                              OID_LENGTH(diaAlarmTime_oid), ASN_UNSIGNED,
                              /*
                               * Set an appropriate value for diaAlarmTime 
                               */
                              (u_char *)&alarmTime, sizeof(alarmTime));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmType_oid,
                              OID_LENGTH(diaAlarmType_oid), ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmType 
                               */
                             (u_char *)&alarmType, sizeof(alarmType));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmProbableCause_oid,
                              OID_LENGTH(diaAlarmProbableCause_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for 
                               * diaAlarmProbableCause 
                               */
                              (u_char *)&probableCause, sizeof(probableCause));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmSeverity_oid,
                              OID_LENGTH(diaAlarmSeverity_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmSeverity 
                               */
                              (u_char *)&alarmSeverity, sizeof(alarmSeverity));
    snmp_varlist_add_variable(&var_list,
                              diaAddText_oid, OID_LENGTH(diaAddText_oid),
                              ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaAddText 
                               */
                              faultText, strlen(faultText));

    /*
     * Add any extra (optional) objects here
     */

    /*
     * Send the trap to the list of configured destinations
     *  and clean up
     */
    send_v2trap(var_list);
    snmp_free_varbind(var_list);
#endif
    return SNMP_ERR_NOERROR;
}
int
send_diaMinorNotification_trap(StackAlarmInfo *alarmInfo, char *faultText)
{
    unsigned long alarmTime;
    int alarmType;
    int probableCause;
    int alarmSeverity;
    char fault_name[100];
    netsnmp_variable_list *var_list = NULL;
    char alarmIdString[ALARM_ID_LEN]={'\0'};
    int alarmId=alarmInfo->stackAlarmId;
    strncpy(alarmIdString,alarmInfo->alarmIdString,ALARM_ID_LEN - 1);
    alarmIdString[ALARM_ID_LEN - 1] = '\0';

    seqNum++;

    if (seqNum >= MAX_SEQUENCE_NUMBER)
    {
        seqNum = 1;
    }
    sprintf(fault_name, "%s", ALARM_FAULTNAME(alarmId));

    alarmType = ALARM_TYPE(alarmId);

    probableCause = ALARM_PROBABLECAUSE(alarmId);

    alarmSeverity = ALARM_SEVERITY(alarmId);

    oid             diaMinorNotification_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 2 };
    oid             diaNotificationSequenceNum_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1000, 0 };
    oid             diaFaultName_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1001, 0 };
    oid             diaAlarmTime_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1002, 0 };
    oid             diaAlarmType_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1003, 0 };
    oid             diaAlarmProbableCause_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1004, 0 };
    oid             diaAlarmSeverity_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1005, 0 };
    oid             diaAddText_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1006, 0 };
    oid             diaAlarmId_oid[] = 
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1007, 0 };

#if defined(_SOL_SNMP_) 
    oid             objid_sysuptime[] = { 1, 3, 6, 1, 2, 1, 1, 3, 0 };
    oid             objid_snmptrap[] = { 1, 3, 6, 1, 6, 3, 1, 1, 4, 1, 0 };
    netsnmp_pdu    *pdu = NULL;
    int inform = 0;
    pdu = snmp_pdu_create(inform ? SNMP_MSG_INFORM : SNMP_MSG_TRAP2);

    char           *trap = NULL;
    char            csysuptime[20];
    long            sysuptime;
    char            diaNotif[MAX_DIA_NTF_LENGTH+1];

    memset(diaNotif, 0, MAX_DIA_NTF_LENGTH+1);
    sprintf(diaNotif, "%s", "DIA-MIB::diaMinorNotification");
    sysuptime = get_uptime();

    sprintf(csysuptime, "%ld", sysuptime);
    trap = csysuptime;
    snmp_add_var(pdu, objid_sysuptime,
                  sizeof(objid_sysuptime) / sizeof(oid), 't', trap);

    snmp_add_var
           (pdu, diaMinorNotification_oid, sizeof(diaMinorNotification_oid) / sizeof(oid),
            'o', &diaNotif); 

    char varSeqNum[20];
    sprintf(varSeqNum, "%d", seqNum);

    snmp_add_var(pdu,diaNotificationSequenceNum_oid, sizeof(diaNotificationSequenceNum_oid)/sizeof(oid), 'c', &varSeqNum);
    snmp_add_var(pdu,diaFaultName_oid, OID_LENGTH(diaFaultName_oid), 's', &fault_name);
    char varAlmTime[30];
    alarmTime = time(NULL);
    sprintf(varAlmTime, "%d", alarmTime);
    snmp_add_var(pdu,diaAlarmTime_oid, OID_LENGTH(diaAlarmTime_oid), 'u', &varAlmTime);
    char varAlmType[30];
    sprintf(varAlmType, "%d", alarmType);
    snmp_add_var(pdu,diaAlarmType_oid, OID_LENGTH(diaAlarmType_oid), 'i', &varAlmType);
    char varProbCause[30];
    sprintf(varProbCause, "%d", probableCause);
    snmp_add_var(pdu,diaAlarmProbableCause_oid, OID_LENGTH(diaAlarmProbableCause_oid), 'i', &varProbCause);
    char varAlmSev[30];
    sprintf(varAlmSev, "%d", alarmSeverity);
    snmp_add_var(pdu,diaAlarmSeverity_oid, OID_LENGTH(diaAlarmSeverity_oid), 'i', &varAlmSev);
    snmp_add_var(pdu,diaAddText_oid, OID_LENGTH(diaAddText_oid), 's', faultText);
     int status = 0;
          status = snmp_send(ss, pdu) ;
    if (status) {
        snmp_sess_perror(inform ? "snmpinform" : "snmptrapppp", ss);
        //exitval = 1;
    }

#else
    /*
     * Set the snmpTrapOid.0 value
     */
    snmp_varlist_add_variable(&var_list,
                              snmptrap_oid, OID_LENGTH(snmptrap_oid),
                              ASN_OBJECT_ID,
                              diaMinorNotification_oid,
                              sizeof(diaMinorNotification_oid));

    snmp_varlist_add_variable(&var_list, 
        diaAlarmId_oid, OID_LENGTH(diaAlarmId_oid), 
        ASN_OCTET_STR, 
        /* Set an appropriate value for diaAlarmId */ 
        alarmIdString, strlen(alarmIdString));
    /*
     * Add any objects from the trap definition
     */
    snmp_varlist_add_variable(&var_list,
                              diaNotificationSequenceNum_oid,
                              OID_LENGTH(diaNotificationSequenceNum_oid),
                              ASN_COUNTER,
                              /*
                               * Set an appropriate value for 
                               * diaNotificationSequenceNum 
                               */
                               (u_char *)&seqNum,            
                              sizeof(seqNum));
    snmp_varlist_add_variable(&var_list,
                              diaFaultName_oid,
                              OID_LENGTH(diaFaultName_oid), ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaFaultName 
                               */
                              fault_name, strlen(fault_name));
    alarmTime = time(NULL);

    snmp_varlist_add_variable(&var_list,
                              diaAlarmTime_oid,
                              OID_LENGTH(diaAlarmTime_oid), ASN_UNSIGNED,
                              /*
                               * Set an appropriate value for diaAlarmTime 
                               */
                              (u_char *)&alarmTime, sizeof(alarmTime));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmType_oid,
                              OID_LENGTH(diaAlarmType_oid), ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmType 
                               */
                              (u_char *)&alarmType, sizeof(alarmType));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmProbableCause_oid,
                              OID_LENGTH(diaAlarmProbableCause_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for 
                               * diaAlarmProbableCause 
                               */
                              (u_char *)&probableCause, sizeof(probableCause));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmSeverity_oid,
                              OID_LENGTH(diaAlarmSeverity_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmSeverity 
                               */
                              (u_char *)&alarmSeverity, sizeof(alarmSeverity));
    snmp_varlist_add_variable(&var_list,
                              diaAddText_oid, OID_LENGTH(diaAddText_oid),
                              ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaAddText 
                               */
                              faultText, strlen(faultText));

    /*
     * Add any extra (optional) objects here
     */

    /*
     * Send the trap to the list of configured destinations
     *  and clean up
     */
    send_v2trap(var_list);
    snmp_free_varbind(var_list);
#endif
    return SNMP_ERR_NOERROR;
}

int
send_diaMajorNotification_trap(StackAlarmInfo * alarmInfo, char *faultText)
{

    unsigned long alarmTime;
    int alarmType;
    int probableCause;
    int alarmSeverity;
    char fault_name[100];
    netsnmp_variable_list *var_list = NULL;
    char alarmIdString[ALARM_ID_LEN]={'\0'};
    int alarmId=alarmInfo->stackAlarmId;
    strncpy(alarmIdString,alarmInfo->alarmIdString,ALARM_ID_LEN - 1);
    alarmIdString[ALARM_ID_LEN - 1] = '\0';


    seqNum++;

    if (seqNum >= MAX_SEQUENCE_NUMBER)
    {
        seqNum = 1;
    }

    sprintf(fault_name, "%s", ALARM_FAULTNAME(alarmId));

    alarmType = ALARM_TYPE(alarmId);

    probableCause = ALARM_PROBABLECAUSE(alarmId);

    alarmSeverity = ALARM_SEVERITY(alarmId);

    oid             diaMajorNotification_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 3 };
    oid             diaNotificationSequenceNum_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1000, 0 };
    oid             diaFaultName_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1001, 0 };
    oid             diaAlarmTime_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1002, 0 };
    oid             diaAlarmType_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1003, 0 };
    oid             diaAlarmProbableCause_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1004, 0 };
    oid             diaAlarmSeverity_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1005, 0 };
    oid             diaAddText_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1006, 0 };
    oid             diaAlarmId_oid[] = 
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1007, 0 };

#if defined(_SOL_SNMP_) 
   oid             objid_sysuptime[] = { 1, 3, 6, 1, 2, 1, 1, 3, 0 };
    oid             objid_snmptrap[] = { 1, 3, 6, 1, 6, 3, 1, 1, 4, 1, 0 };
    netsnmp_pdu    *pdu = NULL;
    int inform = 0;
    pdu = snmp_pdu_create(inform ? SNMP_MSG_INFORM : SNMP_MSG_TRAP2);

    char           *trap = NULL;
    char            csysuptime[20];
    long            sysuptime;
    char            diaNotif[MAX_DIA_NTF_LENGTH+1];

    memset(diaNotif, 0, MAX_DIA_NTF_LENGTH+1);
    sprintf(diaNotif, "%s", "DIA-MIB::diaMajorNotification");
    sysuptime = get_uptime();

    sprintf(csysuptime, "%ld", sysuptime);
    trap = csysuptime;
    snmp_add_var(pdu, objid_sysuptime,
                  sizeof(objid_sysuptime) / sizeof(oid), 't', trap);

    snmp_add_var
           (pdu, diaMajorNotification_oid, sizeof(diaMajorNotification_oid) / sizeof(oid),
            'o', &diaNotif); 

    char varSeqNum[20];
    sprintf(varSeqNum, "%d", seqNum);

    snmp_add_var(pdu,diaNotificationSequenceNum_oid, sizeof(diaNotificationSequenceNum_oid)/sizeof(oid), 'c', &varSeqNum);
    snmp_add_var(pdu,diaFaultName_oid, OID_LENGTH(diaFaultName_oid), 's', &fault_name);
    char varAlmTime[30];
    alarmTime = time(NULL);
    sprintf(varAlmTime, "%d", alarmTime);
    snmp_add_var(pdu,diaAlarmTime_oid, OID_LENGTH(diaAlarmTime_oid), 'u', &varAlmTime);
    char varAlmType[30];
    sprintf(varAlmType, "%d", alarmType);
    snmp_add_var(pdu,diaAlarmType_oid, OID_LENGTH(diaAlarmType_oid), 'i', &varAlmType);
    char varProbCause[30];
    sprintf(varProbCause, "%d", probableCause);
    snmp_add_var(pdu,diaAlarmProbableCause_oid, OID_LENGTH(diaAlarmProbableCause_oid), 'i', &varProbCause);
    char varAlmSev[30];
    sprintf(varAlmSev, "%d", alarmSeverity);
    snmp_add_var(pdu,diaAlarmSeverity_oid, OID_LENGTH(diaAlarmSeverity_oid), 'i', &varAlmSev);
    snmp_add_var(pdu,diaAddText_oid, OID_LENGTH(diaAddText_oid), 's', faultText);
     int status = 0;
          status = snmp_send(ss, pdu) ;
    if (status) {
        snmp_sess_perror(inform ? "snmpinform" : "snmptrapppp", ss);
        //exitval = 1;
    }


#else
    /*
     * Set the snmpTrapOid.0 value
     */
    snmp_varlist_add_variable(&var_list,
                              snmptrap_oid, OID_LENGTH(snmptrap_oid),
                              ASN_OBJECT_ID,
                              diaMajorNotification_oid,
                              sizeof(diaMajorNotification_oid));

    /*
     * Add any objects from the trap definition
     */
    snmp_varlist_add_variable(&var_list, 
        diaAlarmId_oid, OID_LENGTH(diaAlarmId_oid), 
        ASN_OCTET_STR, 
        /* Set an appropriate value for diaAlarmId */ 
        alarmIdString, strlen(alarmIdString));

    snmp_varlist_add_variable(&var_list,
                              diaNotificationSequenceNum_oid,
                              OID_LENGTH(diaNotificationSequenceNum_oid),
                              ASN_COUNTER,
                              /*
                               * Set an appropriate value for 
                               * diaNotificationSequenceNum 
                               */
                              (u_char *)&seqNum,            
                              sizeof(seqNum));
    snmp_varlist_add_variable(&var_list,
                              diaFaultName_oid,
                              OID_LENGTH(diaFaultName_oid), ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaFaultName 
                               */
                              fault_name, strlen(fault_name));
    
    alarmTime = time(NULL);

    snmp_varlist_add_variable(&var_list,
                              diaAlarmTime_oid,
                              OID_LENGTH(diaAlarmTime_oid), ASN_UNSIGNED,
                              /*
                               * Set an appropriate value for diaAlarmTime 
                               */
                              (u_char *)&alarmTime, sizeof(alarmTime));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmType_oid,
                              OID_LENGTH(diaAlarmType_oid), ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmType 
                               */
                              (u_char *)&alarmType, sizeof(alarmType));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmProbableCause_oid,
                              OID_LENGTH(diaAlarmProbableCause_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for 
                               * diaAlarmProbableCause 
                               */
                              (u_char *)&probableCause, sizeof(probableCause));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmSeverity_oid,
                              OID_LENGTH(diaAlarmSeverity_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmSeverity 
                               */
                              (u_char *)&alarmSeverity, sizeof(alarmSeverity));
    snmp_varlist_add_variable(&var_list,
                              diaAddText_oid, OID_LENGTH(diaAddText_oid),
                              ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaAddText 
                               */
                              faultText, strlen(faultText));

    /*
     * Add any extra (optional) objects here
     */

    /*
     * Send the trap to the list of configured destinations
     *  and clean up
     */
    send_v2trap(var_list);
    snmp_free_varbind(var_list);

#endif
    return SNMP_ERR_NOERROR;
}

int
send_diaCriticalNotification_trap(StackAlarmInfo * alarmInfo, char *faultText)
{
   unsigned long alarmTime;
    int alarmType;
    int probableCause;
    int alarmSeverity;
    char fault_name[100];
    netsnmp_variable_list *var_list = NULL;
    char alarmIdString[ALARM_ID_LEN]={'\0'};
    int alarmId=alarmInfo->stackAlarmId;
    strncpy(alarmIdString,alarmInfo->alarmIdString,ALARM_ID_LEN -1);
    alarmIdString[ALARM_ID_LEN -1] = '\0';

    seqNum++;

    if (seqNum >= MAX_SEQUENCE_NUMBER)
    {
        seqNum = 1;
    }
    sprintf(fault_name, "%s", ALARM_FAULTNAME(alarmId));

    alarmType = ALARM_TYPE(alarmId);

    probableCause = ALARM_PROBABLECAUSE(alarmId);

    alarmSeverity = ALARM_SEVERITY(alarmId);


    oid             diaCriticalNotification_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 0 };
    oid             diaNotificationSequenceNum_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1000, 0 };
    oid             diaFaultName_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1001, 0 };
    oid             diaAlarmTime_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1002, 0 };
    oid             diaAlarmType_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1003, 0 };
    oid             diaAlarmProbableCause_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1004, 0 };
    oid             diaAlarmSeverity_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1005, 0 };
    oid             diaAddText_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1006, 0 };
    oid             diaAlarmId_oid[] = 
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1007, 0 };

#if defined(_SOL_SNMP_) 
    oid             objid_sysuptime[] = { 1, 3, 6, 1, 2, 1, 1, 3, 0 };
    oid             objid_snmptrap[] = { 1, 3, 6, 1, 6, 3, 1, 1, 4, 1, 0 };
    netsnmp_pdu    *pdu = NULL;
    int inform = 0;
    pdu = snmp_pdu_create(inform ? SNMP_MSG_INFORM : SNMP_MSG_TRAP2);

    char           *trap = NULL;
    char            csysuptime[20];
    long            sysuptime;
    char            diaNotif[MAX_DIA_NTF_LENGTH+1];

    memset(diaNotif, 0, MAX_DIA_NTF_LENGTH+1);
    sprintf(diaNotif, "%s", "DIA-MIB::diaCriticalNotification");
    sysuptime = get_uptime();

    sprintf(csysuptime, "%ld", sysuptime);
    trap = csysuptime;
    snmp_add_var(pdu, objid_sysuptime,
                  sizeof(objid_sysuptime) / sizeof(oid), 't', trap);

    snmp_add_var
           (pdu, diaCriticalNotification_oid, sizeof(diaCriticalNotification_oid) / sizeof(oid),
            'o', &diaNotif); 

    char varSeqNum[20];
    sprintf(varSeqNum, "%d", seqNum);

    snmp_add_var(pdu,diaNotificationSequenceNum_oid, sizeof(diaNotificationSequenceNum_oid)/sizeof(oid), 'c', &varSeqNum);
    snmp_add_var(pdu,diaFaultName_oid, OID_LENGTH(diaFaultName_oid), 's', &fault_name);
    char varAlmTime[30];
    alarmTime = time(NULL);
    sprintf(varAlmTime, "%d", alarmTime);
    snmp_add_var(pdu,diaAlarmTime_oid, OID_LENGTH(diaAlarmTime_oid), 'u', &varAlmTime);
    char varAlmType[30];
    sprintf(varAlmType, "%d", alarmType);
    snmp_add_var(pdu,diaAlarmType_oid, OID_LENGTH(diaAlarmType_oid), 'i', &varAlmType);
    char varProbCause[30];
    sprintf(varProbCause, "%d", probableCause);
    snmp_add_var(pdu,diaAlarmProbableCause_oid, OID_LENGTH(diaAlarmProbableCause_oid), 'i', &varProbCause);
    char varAlmSev[30];
    sprintf(varAlmSev, "%d", alarmSeverity);
    snmp_add_var(pdu,diaAlarmSeverity_oid, OID_LENGTH(diaAlarmSeverity_oid), 'i', &varAlmSev);
    snmp_add_var(pdu,diaAddText_oid, OID_LENGTH(diaAddText_oid), 's', faultText);
     int status = 0;
          status = snmp_send(ss, pdu) ;
    if (status) {
        snmp_sess_perror(inform ? "snmpinform" : "snmptrapppp", ss);
        //exitval = 1;
    }

#else

    /*
     * Set the snmpTrapOid.0 value
     */
    snmp_varlist_add_variable(&var_list,
                              snmptrap_oid, OID_LENGTH(snmptrap_oid),
                              ASN_OBJECT_ID,
                              diaCriticalNotification_oid,
                              sizeof(diaCriticalNotification_oid));

    /*
     * Add any objects from the trap definition
     */
    snmp_varlist_add_variable(&var_list, 
        diaAlarmId_oid, OID_LENGTH(diaAlarmId_oid), 
        ASN_OCTET_STR, 
        /* Set an appropriate value for diaAlarmId */ 
        alarmIdString, strlen(alarmIdString));

    snmp_varlist_add_variable(&var_list,
                              diaNotificationSequenceNum_oid,
                              OID_LENGTH(diaNotificationSequenceNum_oid),
                              ASN_COUNTER,
                              /*
                               * Set an appropriate value for 
                               * diaNotificationSequenceNum 
                               */
                              (u_char *)&seqNum,            
                              sizeof(seqNum));
    snmp_varlist_add_variable(&var_list,
                              diaFaultName_oid,
                              OID_LENGTH(diaFaultName_oid), ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaFaultName 
                               */
                              fault_name, strlen(fault_name));
    
    alarmTime = time(NULL);

    snmp_varlist_add_variable(&var_list,
                              diaAlarmTime_oid,
                              OID_LENGTH(diaAlarmTime_oid), ASN_UNSIGNED,
                              /*
                               * Set an appropriate value for diaAlarmTime 
                               */
                              (u_char *)&alarmTime, sizeof(alarmTime));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmType_oid,
                              OID_LENGTH(diaAlarmType_oid), ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmType 
                               */
                              (u_char *)&alarmType, sizeof(alarmType));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmProbableCause_oid,
                              OID_LENGTH(diaAlarmProbableCause_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for 
                               * diaAlarmProbableCause 
                               */
                              (u_char *)&probableCause, sizeof(probableCause));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmSeverity_oid,
                              OID_LENGTH(diaAlarmSeverity_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmSeverity 
                               */
                              (u_char *)&alarmSeverity, sizeof(alarmSeverity));
    snmp_varlist_add_variable(&var_list,
                              diaAddText_oid, OID_LENGTH(diaAddText_oid),
                              ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaAddText 
                               */
                              faultText, strlen(faultText));

    /*
     * Add any extra (optional) objects here
     */

    /*
     * Send the trap to the list of configured destinations
     *  and clean up
     */
    send_v2trap(var_list);
    snmp_free_varbind(var_list);
#endif
    return SNMP_ERR_NOERROR;
}

int
send_diaInfoNotification_trap(StackAlarmInfo * alarmInfo, char *faultText)
{
    unsigned long alarmTime;
    int alarmType;
    int probableCause;
    int alarmSeverity;
    char fault_name[100];
    netsnmp_variable_list *var_list = NULL;
    char alarmIdString[ALARM_ID_LEN]={'\0'};
    int alarmId=alarmInfo->stackAlarmId;
    strncpy(alarmIdString,alarmInfo->alarmIdString,ALARM_ID_LEN - 1);
    alarmIdString[ALARM_ID_LEN - 1] = '\0';

    seqNum++;

    if (seqNum >= MAX_SEQUENCE_NUMBER)
    {
        seqNum = 1;
    }
    sprintf(fault_name, "%s", ALARM_FAULTNAME(alarmId));

    alarmType = ALARM_TYPE(alarmId);

    probableCause = ALARM_PROBABLECAUSE(alarmId);

    alarmSeverity = ALARM_SEVERITY(alarmId);

    oid             diaInfoNotification_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 5 };
    oid             diaNotificationSequenceNum_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1000, 0 };
    oid             diaFaultName_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1001, 0 };
    oid             diaAlarmTime_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1002, 0 };
    oid             diaAlarmType_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1003, 0 };
    oid             diaAlarmProbableCause_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1004, 0 };
    oid             diaAlarmSeverity_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1005, 0 };
    oid             diaAddText_oid[] =
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1006, 0 };
    oid             diaAlarmId_oid[] = 
        { 1, 3, 6, 1, 4, 1, 2763, 1, 1, 3, 1, 1, 1007, 0 };

#if defined(_SOL_SNMP_) 
    oid             objid_sysuptime[] = { 1, 3, 6, 1, 2, 1, 1, 3, 0 };
    oid             objid_snmptrap[] = { 1, 3, 6, 1, 6, 3, 1, 1, 4, 1, 0 };
    netsnmp_pdu    *pdu = NULL;
    int inform = 0;
    pdu = snmp_pdu_create(inform ? SNMP_MSG_INFORM : SNMP_MSG_TRAP2);

    char           *trap = NULL;
    char            csysuptime[20];
    long            sysuptime;
    char            diaNotif[MAX_DIA_NTF_LENGTH+1];

    memset(diaNotif, 0, MAX_DIA_NTF_LENGTH+1);
    sprintf(diaNotif, "%s", "DIA-MIB::diaInfoNotification");
    sysuptime = get_uptime();

    sprintf(csysuptime, "%ld", sysuptime);
    trap = csysuptime;
    snmp_add_var(pdu, objid_sysuptime,
                  sizeof(objid_sysuptime) / sizeof(oid), 't', trap);

    snmp_add_var
           (pdu, diaInfoNotification_oid, sizeof(diaInfoNotification_oid) / sizeof(oid),
            'o', &diaNotif); 

    char varSeqNum[20];
    sprintf(varSeqNum, "%d", seqNum);

    snmp_add_var(pdu,diaNotificationSequenceNum_oid, sizeof(diaNotificationSequenceNum_oid)/sizeof(oid), 'c', &varSeqNum);
    snmp_add_var(pdu,diaFaultName_oid, OID_LENGTH(diaFaultName_oid), 's', &fault_name);
    char varAlmTime[30];
    alarmTime = time(NULL);
    sprintf(varAlmTime, "%d", alarmTime);
    snmp_add_var(pdu,diaAlarmTime_oid, OID_LENGTH(diaAlarmTime_oid), 'u', &varAlmTime);
    char varAlmType[30];
    sprintf(varAlmType, "%d", alarmType);
    snmp_add_var(pdu,diaAlarmType_oid, OID_LENGTH(diaAlarmType_oid), 'i', &varAlmType);
    char varProbCause[30];
    sprintf(varProbCause, "%d", probableCause);
    snmp_add_var(pdu,diaAlarmProbableCause_oid, OID_LENGTH(diaAlarmProbableCause_oid), 'i', &varProbCause);
    char varAlmSev[30];
    sprintf(varAlmSev, "%d", alarmSeverity);
    snmp_add_var(pdu,diaAlarmSeverity_oid, OID_LENGTH(diaAlarmSeverity_oid), 'i', &varAlmSev);
    snmp_add_var(pdu,diaAddText_oid, OID_LENGTH(diaAddText_oid), 's', faultText);
     int status = 0;
          status = snmp_send(ss, pdu) ;
    if (status) {
        snmp_sess_perror(inform ? "snmpinform" : "snmptrapppp", ss);
        //exitval = 1;
    }

#else
    /*
     * Set the snmpTrapOid.0 value
     */
    snmp_varlist_add_variable(&var_list,
                              snmptrap_oid, OID_LENGTH(snmptrap_oid),
                              ASN_OBJECT_ID,
                              diaInfoNotification_oid,
                              sizeof(diaInfoNotification_oid));

    /*
     * Add any objects from the trap definition
     */
    snmp_varlist_add_variable(&var_list, 
        diaAlarmId_oid, OID_LENGTH(diaAlarmId_oid), 
        ASN_OCTET_STR, 
        /* Set an appropriate value for diaAlarmId */ 
        alarmIdString, strlen(alarmIdString));


    snmp_varlist_add_variable(&var_list,
                              diaNotificationSequenceNum_oid,
                              OID_LENGTH(diaNotificationSequenceNum_oid),
                              ASN_COUNTER,
                              /*
                               * Set an appropriate value for 
                               * diaNotificationSequenceNum 
                               */
                               (u_char *)&seqNum,            
                              sizeof(seqNum));
    snmp_varlist_add_variable(&var_list,
                              diaFaultName_oid,
                              OID_LENGTH(diaFaultName_oid), ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaFaultName 
                               */
                              fault_name, strlen(fault_name));
    alarmTime = time(NULL);

    snmp_varlist_add_variable(&var_list,
                              diaAlarmTime_oid,
                              OID_LENGTH(diaAlarmTime_oid), ASN_UNSIGNED,
                              /*
                               * Set an appropriate value for diaAlarmTime 
                               */
                              (u_char *)&alarmTime, sizeof(alarmTime));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmType_oid,
                              OID_LENGTH(diaAlarmType_oid), ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmType 
                               */
                              (u_char *)&alarmType, sizeof(alarmType));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmProbableCause_oid,
                              OID_LENGTH(diaAlarmProbableCause_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for 
                               * diaAlarmProbableCause 
                               */
                              (u_char *)&probableCause, sizeof(probableCause));
    snmp_varlist_add_variable(&var_list,
                              diaAlarmSeverity_oid,
                              OID_LENGTH(diaAlarmSeverity_oid),
                              ASN_INTEGER,
                              /*
                               * Set an appropriate value for diaAlarmSeverity 
                               */
                              (u_char *)&alarmSeverity, sizeof(alarmSeverity));
    snmp_varlist_add_variable(&var_list,
                              diaAddText_oid, OID_LENGTH(diaAddText_oid),
                              ASN_OCTET_STR,
                              /*
                               * Set an appropriate value for diaAddText 
                               */
                              faultText, strlen(faultText));

    /*
     * Add any extra (optional) objects here
     */

    /*
     * Send the trap to the list of configured destinations
     *  and clean up
     */
    send_v2trap(var_list);
    snmp_free_varbind(var_list);
#endif
    return SNMP_ERR_NOERROR;
}

